<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <style>
      div {
        width: 200px;
        height: 200px;
      }
    </style>
  </head>
  <body>
    <div>
      输入窗口: id=input
      <input id="input" type="file" onchange="showimg(this)"><br>
      远程链接图片: id=image
      显示预览图片: id=image2
      <img id="image2" href="http://obin1ocvc.bkt.clouddn.com/portrait.png" width="100" height="100" alt="头像"><br>
    </div>
    <div id="result">
    </div>
    <script>
      input = document.getElementById("input");
      image = document.getElementById("image");
      image2 = document.getElementById("image2");
      result = document.getElementById("result");
      function showimg(dom) {
        f = input.files[0];
        r = new FileReader();
        r.onloadend = function () {
          text = r.result
          image2.src = text;
          file = convertBase64UrlToBlob(text);
          console.log(wx=file);
        };
        r.readAsDataURL(f);
      }
      function convertBase64UrlToBlob(urlData){  
          var bytes=window.atob(urlData.split(',')[1]);        //去掉url的头，并转换为byte  
          //处理异常,将ascii码小于0的转换为大于0  
          var ab = new ArrayBuffer(bytes.length);  
          var ia = new Uint8Array(ab);  
          for (var i = 0; i < bytes.length; i++) {  
              ia[i] = bytes.charCodeAt(i);  
          }  
        
          return new Blob( [ab] , {type : 'image/png'});  
      }  
    </script>
    <a href="http://blog.csdn.net/hongwangzhang/article/details/50215761">把base64的字符串变成文件</a>
  </body>
</html>
